<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Extend Project Form View -->
    <record id="view_project_form_extended" model="ir.ui.view">
        <field name="name">project.project.form.extended</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet" position="inside">
                <!-- Notification Alerts -->
                <div class="alert alert-danger" role="alert" invisible="has_urgent_notifications == False">
                    <strong>üö® URGENT NOTIFICATIONS:</strong>
                    <ul>
                        <li invisible="has_expiring_domains == False">Some domains have expired or will expire very soon!</li>
                        <li invisible="has_expiring_hosting == False">Some hosting services have expired or will expire very soon!</li>
                    </ul>
                    <p>Please review the Domains and Hosting tabs immediately.</p>
                </div>
                
                <notebook>
                    <!-- Financial Summary -->
                    <page string="Financial Summary">
                        <group>
                            <group string="Financial Overview">
                                <field name="total_income" readonly="1"/>
                                <field name="total_expense" readonly="1"/>
                                <field name="net_profit" readonly="1"/>
                                <field name="amount_due" readonly="1"/>
                            </group>
                            <group string="Service Counts">
                                <field name="domain_count" readonly="1"/>
                                <field name="hosting_count" readonly="1"/>
                                <field name="other_service_count" readonly="1"/>
                            </group>
                            <group string="Notification Status" groups="base.group_no_one">
                                <field name="has_expiring_domains"/>
                                <field name="has_expiring_hosting"/>
                                <field name="has_urgent_notifications"/>
                            </group>
                        </group>
                    </page>
                    
                    <!-- Domains Tab -->
                    <page string="Domains" decoration-danger="has_expiring_domains">
                        <div class="alert alert-warning" role="alert" invisible="has_expiring_domains == False">
                            <strong>‚ö†Ô∏è Warning: Some domains are expiring soon or have expired!</strong>
                        </div>
                        <field name="domain_ids" context="{'default_project_id': id, 'default_client_id': partner_id}">
                            <list decoration-warning="expiry_status == 'warning'" decoration-danger="expiry_status in ['urgent', 'expired']" string="Domains">
                                <field name="name"/>
                                <field name="expiry_date"/>
                                <field name="expiry_status" widget="badge" decoration-success="expiry_status == 'valid'" decoration-warning="expiry_status == 'warning'" decoration-danger="expiry_status in ['urgent', 'expired']"/>
                            </list>
                        </field>
                    </page>
                    
                    <!-- Hosting Tab -->
                    <page string="Hosting Services" decoration-danger="has_expiring_hosting">
                        <div class="alert alert-warning" role="alert" invisible="has_expiring_hosting == False">
                            <strong>‚ö†Ô∏è Warning: Some hosting services are expiring soon or have expired!</strong>
                        </div>
                        <field name="hosting_ids" context="{'default_project_id': id, 'default_client_id': partner_id}">
                            <list decoration-warning="expiry_status == 'warning'" decoration-danger="expiry_status in ['urgent', 'expired']" string="Hosting Services">
                                <field name="name"/>
                                <field name="expiry_date"/>
                                <field name="expiry_status" widget="badge" decoration-success="expiry_status == 'valid'" decoration-warning="expiry_status == 'warning'" decoration-danger="expiry_status in ['urgent', 'expired']"/>
                            </list>
                        </field>
                    </page>

                    <!-- Other Services Tab -->
                    <page string="Other Services">
                        <field name="other_service_ids" context="{'default_project_id': id, 'default_client_id': partner_id}">
                            <list string="Other Services">
                                <field name="name"/>
                                <field name="date"/>
                                <field name="description"/>
                            </list>
                        </field>
                    </page>
                    
                    <!-- Incomes Tab -->
                    <page string="Incomes">
                        <field name="income_ids">
                            <list editable="bottom">
                                <field name="client_id"/>
                                <field name="amount"/>
                                <field name="date"/>
                                <field name="description"/>
                            </list>
                        </field>
                    </page>
                    
                    <!-- Expenses Tab -->
                    <page string="Expenses">
                        <field name="expense_ids">
                            <list editable="bottom">
                                <field name="expense_type"/>
                                <field name="amount"/>
                                <field name="date"/>
                                <field name="employee_id" invisible="expense_type != 'salary'"/>
                                <field name="notes"/>
                            </list>
                        </field>
                    </page>
                </notebook>
            </xpath>
        </field>
    </record>
</odoo>
