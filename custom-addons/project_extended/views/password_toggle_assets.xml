<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="password_toggle_assets" name="Password Toggle Assets">
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() {
                // Function to initialize password toggle
                function initPasswordToggle() {
                    setTimeout(function() {
                        const toggleButtons = document.querySelectorAll('.o_toggle_password');
                        toggleButtons.forEach(function(button) {
                            if (!button.hasEventListener) {
                                button.addEventListener('click', function(e) {
                                    e.preventDefault();
                                    e.stopPropagation();
                                    
                                    const passwordDiv = this.parentElement;
                                    const passwordField = passwordDiv.querySelector('.o_password_field input');
                                    
                                    if (passwordField) {
                                        if (passwordField.type === 'password') {
                                            passwordField.type = 'text';
                                            this.textContent = 'üôà';
                                        } else {
                                            passwordField.type = 'password';
                                            this.textContent = 'üëÅÔ∏è';
                                        }
                                    }
                                });
                                button.hasEventListener = true;
                            }
                        });
                    }, 100);
                }
                
                // Initialize immediately
                initPasswordToggle();
                
                // Re-initialize on form changes
                const observer = new MutationObserver(function() {
                    initPasswordToggle();
                });
                
                observer.observe(document.body, {
                    childList: true,
                    subtree: true
                });
            });
        </script>
    </template>
</odoo>
